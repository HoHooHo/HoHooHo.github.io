<!DOCTYPE html>
<html lang="zh">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://hohooho.github.io/OpenGL/%E5%85%89%E6%BA%90/">
        <link rel="shortcut icon" href="../../theme/favicon.ico">
        
        <title>光源 - 梦之斋</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/darcula.min.css">
        <link href="../../css/markdown-it-admonition.css" rel="stylesheet">
        <link href="../../css/style.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">

				
                <a href="../.."><img class="user-avatar" src="../../theme/avatar.png" alt="头像"></a>
				
				
				<!--
                <a class="navbar-brand" href="../..">梦之斋</a>
				 -->
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">首页</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">OpenGL <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Pipeline/" class="dropdown-item">渲染管线</a>
</li>
                                    
<li>
    <a href="../VAO_VBO_EBO/" class="dropdown-item">VAO、VBO、EBO</a>
</li>
                                    
<li>
    <a href="../%E5%85%89%E7%85%A7/" class="dropdown-item">光照</a>
</li>
                                    
<li>
    <a href="../%E6%B3%95%E7%BA%BF%E8%B4%B4%E5%9B%BE/" class="dropdown-item">法线贴图</a>
</li>
                                    
<li>
    <a href="../%E6%9D%90%E8%B4%A8/" class="dropdown-item">材质</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">光源</a>
</li>
                                    
<li>
    <a href="../%E5%87%A0%E4%BD%95%E7%9D%80%E8%89%B2%E5%99%A8/" class="dropdown-item">几何着色器</a>
</li>
                                    
<li>
    <a href="../%E9%AB%98%E7%BA%A7GLSL/" class="dropdown-item">高级GLSL</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">UE4 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../UE4/Pitch_Yaw_Roll/" class="dropdown-item">Pitch，Yaw，Roll</a>
</li>
                                    
<li>
    <a href="../../UE4/%E5%88%9B%E5%BB%BA%E7%BB%84%E4%BB%B6/" class="dropdown-item">创建组件</a>
</li>
                                    
<li>
    <a href="../../UE4/Server-Client%E6%9E%B6%E6%9E%84/" class="dropdown-item">Server-Client架构</a>
</li>
                                    
<li>
    <a href="../../UE4/UE4%E7%9A%84%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" class="dropdown-item">UE4的垃圾回收</a>
</li>
                                    
<li>
    <a href="../../UE4/%E8%87%AA%E5%8A%A8%E7%BC%96%E8%AF%91%E6%96%B0%E5%88%9B%E5%BB%BA%E7%9A%84C%2B%2B%E7%B1%BB/" class="dropdown-item">自动编译新创建的C++类</a>
</li>
                                    
<li>
    <a href="../../UE4/%E9%83%A8%E7%BD%B2iOS%E6%89%93%E5%8C%85%E7%8E%AF%E5%A2%83/" class="dropdown-item">部署iOS打包环境</a>
</li>
                                    
<li>
    <a href="../../UE4/%E7%94%9F%E6%88%90xcode%E5%B7%A5%E7%A8%8B%E6%96%87%E4%BB%B6/" class="dropdown-item">生成xcode工程文件</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">小记 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Note/AppleWWDRCA%E8%AF%81%E4%B9%A6/" class="dropdown-item">AppleWWDRCA证书</a>
</li>
                                    
<li>
    <a href="../../Note/Mac%E5%AE%89%E8%A3%85Homebrew/" class="dropdown-item">Mac安装Homebrew</a>
</li>
                                    
<li>
    <a href="../../Note/Mac%E5%8D%B8%E8%BD%BDJDK/" class="dropdown-item">Mac卸载JDK</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">面试 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Interview/C%2B%2B%E5%9F%BA%E7%A1%80/" class="dropdown-item">C++基础</a>
</li>
                                    
<li>
    <a href="../../Interview/C%2B%2B%E9%AB%98%E7%BA%A7/" class="dropdown-item">C++高级</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">读后感 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Read/%E7%A6%BB%E7%BB%8F%E5%8F%9B%E9%81%93/" class="dropdown-item">离经叛道</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../markdown/" class="nav-link">markdown语法</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> 搜索
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../%E6%9D%90%E8%B4%A8/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> 上一页
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../%E5%87%A0%E4%BD%95%E7%9D%80%E8%89%B2%E5%99%A8/" class="nav-link">
                                    下一页 <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/HoHooHo/HoHooHo.github.io" class="nav-link"><i class="fa fa-github"></i> GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#_1" class="nav-link">光源</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#directional-light" class="nav-link">定向光源(Directional Light)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#point-light" class="nav-link">点光源(Point Light)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#spot-light" class="nav-link">聚光源(Spot Light)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#shader" class="nav-link">多光源 Shader</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="_1">光源<a class="headerlink" href="#_1" title="Permanent link">#</a></h1>
<p><a href="https://learnopengl-cn.github.io/02%20Lighting/05%20Light%20casters/">参考 https://learnopengl-cn.github.io/02%20Lighting/05%20Light%20casters/</a></p>
<h2 id="directional-light">定向光源(Directional Light)<a class="headerlink" href="#directional-light" title="Permanent link">#</a></h2>
<p>当一个光源处于很远的地方时，来自光源的每条光线就会近似于互相平行。不论物体和观察者在什么位置，看起来好像所有的光都来自于同一个方向。当我们使用一个假设光源处于无限远处的模型时，它就被称为定向光，因为所有的光线都是平行的，所以物体与光源的相对位置就不重要了。适用于模拟太阳光。</p>
<div class="admonition back">
<p class="admonition-title">Back</p>
<p><img alt="light_casters_directional.png" src="../assets/light_casters_directional.png" /></p>
</div>
<p>我们可以定义一个方向向量而不是位置向量来模拟一个定向光</p>
<pre><code class="language-c">struct Light {
    // vec3 position; // 使用定向光就不再需要了
    vec3 direction;

    vec3 ambient;
    vec3 diffuse;
    vec3 specular;
};
...
void main()
{
  vec3 lightDir = normalize(-light.direction);
  ...
}
</code></pre>
<div class="admonition warning">
<p class="admonition-title">注意</p>
<p>我们目前使用的光照计算需要一个从片段至光源的光线方向，但人们更习惯定义定向光为一个从光源出发的全局方向。所以我们需要对全局光照方向向量取反来改变它的方向。</p>
</div>
<h2 id="point-light">点光源(Point Light)<a class="headerlink" href="#point-light" title="Permanent link">#</a></h2>
<p>点光源是处于世界中某一个位置的光源，它会朝着所有方向发光，但光线会随着距离逐渐衰减。适用于模拟灯泡。</p>
<h3 id="_2">衰减<a class="headerlink" href="#_2" title="Permanent link">#</a></h3>
<p>衰减(Attenuation)：随着光线传播距离的增长逐渐削减光的强度。</p>
<p>在现实世界中，灯泡在近处通常会非常亮，但随着距离的增加光源的亮度一开始会下降非常快，但在远处时剩余的光强度就会下降的非常缓慢了。</p>
<div class="admonition info">
<p class="admonition-title">衰减公式</p>
<p>
<script type="math/tex; mode=display">
F_{att} = \frac{1.0}{K_c + K_l * d + K_q * d^2}
</script>
</p>
<p>d：片段到光源的距离<br />
<script type="math/tex">K_c</script>：常数项。通常为1.0，它的主要作用是保证分母永远大于1，否则在某些距离上它反而会增加强度。<br />
<script type="math/tex">K_l</script>：一次项。与距离值相乘，保证光以线性的方式减少强度。<br />
<script type="math/tex">K_q</script>：二次项。与距离的平方相乘，在距离比较小的时候影响会比一次项小很多，但当距离值比较大的时候它就会比一次项更大了。</p>
</div>
<div class="admonition back">
<p class="admonition-title">Back</p>
<p>下图可以看到光在近距离的时候有着最高的强度，但随着距离增长，它的强度明显减弱，并缓慢地在距离大约100的时候强度接近0</p>
<p><img alt="attenuation.png" src="../assets/attenuation.png" /></p>
<p><img alt="light_casters_point.png" src="../assets/light_casters_point.png" /></p>
</div>
<pre><code class="language-c">struct Light {
    vec3 position;  

    vec3 ambient;
    vec3 diffuse;
    vec3 specular;

    float constant;
    float linear;
    float quadratic;
};

//...省略部分代码

void main()
{
    // ambient
    vec3 ambient = light.ambient * texture(material.diffuse, TexCoords).rgb;

    // diffuse 
    vec3 norm = normalize(Normal);
    vec3 lightDir = normalize(light.position - FragPos);
    float diff = max(dot(norm, lightDir), 0.0);
    vec3 diffuse = light.diffuse * diff * texture(material.diffuse, TexCoords).rgb;  

    // specular
    vec3 viewDir = normalize(viewPos - FragPos);
    vec3 reflectDir = reflect(-lightDir, norm);  
    float spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);
    vec3 specular = light.specular * spec * texture(material.specular, TexCoords).rgb;  

    // attenuation
    float distance    = length(light.position - FragPos);
    float attenuation = 1.0 / (light.constant + light.linear * distance + light.quadratic * (distance * distance));    

    ambient  *= attenuation;  
    diffuse   *= attenuation;
    specular *= attenuation;   

    vec3 result = ambient + diffuse + specular;
    FragColor = vec4(result, 1.0);
} 
</code></pre>
<h4 id="_3">常用数值<a class="headerlink" href="#_3" title="Permanent link">#</a></h4>
<p><a href="https://wiki.ogre3d.org/tiki-index.php?page=-Point+Light+Attenuation">Ogre3D的Wiki</a></p>
<table>
<thead>
<tr>
<th>距离</th>
<th>常数项</th>
<th>一次项</th>
<th>二次项</th>
</tr>
</thead>
<tbody>
<tr>
<td>7</td>
<td>1.0</td>
<td>0.7</td>
<td>1.8</td>
</tr>
<tr>
<td>13</td>
<td>1.0</td>
<td>0.35</td>
<td>0.44</td>
</tr>
<tr>
<td>20</td>
<td>1.0</td>
<td>0.22</td>
<td>0.20</td>
</tr>
<tr>
<td>32</td>
<td>1.0</td>
<td>0.14</td>
<td>0.07</td>
</tr>
<tr>
<td>50</td>
<td>1.0</td>
<td>0.09</td>
<td>0.032</td>
</tr>
<tr>
<td>65</td>
<td>1.0</td>
<td>0.07</td>
<td>0.017</td>
</tr>
<tr>
<td>100</td>
<td>1.0</td>
<td>0.045</td>
<td>0.0075</td>
</tr>
<tr>
<td>160</td>
<td>1.0</td>
<td>0.027</td>
<td>0.0028</td>
</tr>
<tr>
<td>200</td>
<td>1.0</td>
<td>0.022</td>
<td>0.0019</td>
</tr>
<tr>
<td>325</td>
<td>1.0</td>
<td>0.014</td>
<td>0.0007</td>
</tr>
<tr>
<td>600</td>
<td>1.0</td>
<td>0.007</td>
<td>0.0002</td>
</tr>
<tr>
<td>3250</td>
<td>1.0</td>
<td>0.0014</td>
<td>0.000007</td>
</tr>
</tbody>
</table>
<h2 id="spot-light">聚光源(Spot Light)<a class="headerlink" href="#spot-light" title="Permanent link">#</a></h2>
<p>聚光源是从锥形空间中的一个单独的点处发出光照的光源。适用于模拟手电筒。</p>
<p>OpenGL中聚光是用一个世界空间位置、一个方向和一个切光角(Cutoff Angle)来表示的，切光角指定了聚光的半径（圆锥的半径）。</p>
<div class="admonition back">
<p class="admonition-title">Back</p>
<p><img alt="light_casters_spotlight_angles.png" src="../assets/light_casters_spotlight_angles.png" /></p>
<ul>
<li><code>LightDir</code>：从片段指向光源的向量。</li>
<li><code>SpotDir</code>：聚光所指向的方向。</li>
<li><code>Phi</code><script type="math/tex">\phi</script>：指定了聚光半径的切光角。落在这个角度之外的物体都不会被这个聚光所照亮。</li>
<li><code>Theta</code><script type="math/tex">\theta</script>：向量 <script type="math/tex">\bar{LightDir}</script>和<script type="math/tex">\bar{SpotDir}</script> 之间的夹角。在聚光源内部的话<script type="math/tex">\theta</script>值应该比<script type="math/tex">\phi</script>值小。</li>
</ul>
</div>
<p>所以我们要做的就是计算向量 <script type="math/tex">\bar{LightDir}</script>和<script type="math/tex">\bar{SpotDir}</script> 的点积，并将它与切光角 <script type="math/tex">\phi</script> 对比。</p>
<h3 id="_4">平滑/软化边缘<a class="headerlink" href="#_4" title="Permanent link">#</a></h3>
<p>为了创建一种看起来边缘平滑的聚光，我们需要模拟聚光源有一个内圆锥(Inner Cone)和一个外圆锥(Outer Cone),让光从内圆锥逐渐减暗，直到外圆锥的边界。</p>
<ul>
<li>如果片段在 内圆锥之内，它的强度是 1.0</li>
<li>如果片段在 外圆锥之外，它的强度是 0.0</li>
<li>如果片段在 内外圆锥之间，它的强度是 0.0 ~ 1.0</li>
</ul>
<div class="admonition info">
<p class="admonition-title">强度公式</p>
<p>
<script type="math/tex; mode=display">
    I = \frac{cos\theta - cos\gamma}{cos\phi - cos\gamma}
</script>
</p>
<p>
<script type="math/tex">\theta</script>：向量 <script type="math/tex">\bar{LightDir}</script>和<script type="math/tex">\bar{SpotDir}</script> 之间的夹角<br />
<script type="math/tex">\phi</script>：聚光半径的<strong>内切光角</strong><br />
<script type="math/tex">\gamma</script>：聚光半径的<strong>外切光角</strong><br />
<script type="math/tex">I</script>：在当前片段聚光的强度  </p>
</div>
<pre><code class="language-c">struct Light {
    vec3 position;  
    vec3 direction;
    float cutOff;
    float outerCutOff;

    vec3 ambient;
    vec3 diffuse;
    vec3 specular;

    float constant;
    float linear;
    float quadratic;
};

//... 省略部分代码

void main()
{
    // ambient
    vec3 ambient = light.ambient * texture(material.diffuse, TexCoords).rgb;

    // diffuse 
    vec3 norm = normalize(Normal);
    vec3 lightDir = normalize(light.position - FragPos);
    float diff = max(dot(norm, lightDir), 0.0);
    vec3 diffuse = light.diffuse * diff * texture(material.diffuse, TexCoords).rgb;  

    // specular
    vec3 viewDir = normalize(viewPos - FragPos);
    vec3 reflectDir = reflect(-lightDir, norm);  
    float spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);
    vec3 specular = light.specular * spec * texture(material.specular, TexCoords).rgb;  

    // spotlight (soft edges)
    float theta = dot(lightDir, normalize(-light.direction)); 
    float epsilon = (light.cutOff - light.outerCutOff);
    float intensity = clamp((theta - light.outerCutOff) / epsilon, 0.0, 1.0);
    diffuse  *= intensity;
    specular *= intensity;

    // attenuation
    float distance    = length(light.position - FragPos);
    float attenuation = 1.0 / (light.constant + light.linear * distance + light.quadratic * (distance * distance));    
    ambient  *= attenuation; 
    diffuse   *= attenuation;
    specular *= attenuation;   

    vec3 result = ambient + diffuse + specular;
    FragColor = vec4(result, 1.0);
} 
</code></pre>
<h2 id="shader">多光源 Shader<a class="headerlink" href="#shader" title="Permanent link">#</a></h2>
<pre><code class="language-c">#version 330 core
out vec4 FragColor;

struct Material {
    sampler2D diffuse;
    sampler2D specular;
    float shininess;
}; 

struct DirLight {
    vec3 direction;

    vec3 ambient;
    vec3 diffuse;
    vec3 specular;
};

struct PointLight {
    vec3 position;

    float constant;
    float linear;
    float quadratic;

    vec3 ambient;
    vec3 diffuse;
    vec3 specular;
};

struct SpotLight {
    vec3 position;
    vec3 direction;
    float cutOff;
    float outerCutOff;

    float constant;
    float linear;
    float quadratic;

    vec3 ambient;
    vec3 diffuse;
    vec3 specular;       
};

#define NR_POINT_LIGHTS 4

in vec3 FragPos;
in vec3 Normal;
in vec2 TexCoords;

uniform vec3 viewPos;
uniform DirLight dirLight;
uniform PointLight pointLights[NR_POINT_LIGHTS];
uniform SpotLight spotLight;
uniform Material material;

// function prototypes
vec3 CalcDirLight(DirLight light, vec3 normal, vec3 viewDir);
vec3 CalcPointLight(PointLight light, vec3 normal, vec3 fragPos, vec3 viewDir);
vec3 CalcSpotLight(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir);

void main()
{    
    // properties
    vec3 norm = normalize(Normal);
    vec3 viewDir = normalize(viewPos - FragPos);

    // == =====================================================
    // Our lighting is set up in 3 phases: directional, point lights and an optional flashlight
    // For each phase, a calculate function is defined that calculates the corresponding color
    // per lamp. In the main() function we take all the calculated colors and sum them up for
    // this fragment's final color.
    // == =====================================================
    // phase 1: directional lighting
    vec3 result = CalcDirLight(dirLight, norm, viewDir);
    // phase 2: point lights
    for(int i = 0; i &lt; NR_POINT_LIGHTS; i++)
        result += CalcPointLight(pointLights[i], norm, FragPos, viewDir);    
    // phase 3: spot light
    result += CalcSpotLight(spotLight, norm, FragPos, viewDir);    

    FragColor = vec4(result, 1.0);
}

// calculates the color when using a directional light.
vec3 CalcDirLight(DirLight light, vec3 normal, vec3 viewDir)
{
    vec3 lightDir = normalize(-light.direction);
    // diffuse shading
    float diff = max(dot(normal, lightDir), 0.0);
    // specular shading
    vec3 reflectDir = reflect(-lightDir, normal);
    float spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);
    // combine results
    vec3 ambient = light.ambient * vec3(texture(material.diffuse, TexCoords));
    vec3 diffuse = light.diffuse * diff * vec3(texture(material.diffuse, TexCoords));
    vec3 specular = light.specular * spec * vec3(texture(material.specular, TexCoords));
    return (ambient + diffuse + specular);
}

// calculates the color when using a point light.
vec3 CalcPointLight(PointLight light, vec3 normal, vec3 fragPos, vec3 viewDir)
{
    vec3 lightDir = normalize(light.position - fragPos);
    // diffuse shading
    float diff = max(dot(normal, lightDir), 0.0);
    // specular shading
    vec3 reflectDir = reflect(-lightDir, normal);
    float spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);
    // attenuation
    float distance = length(light.position - fragPos);
    float attenuation = 1.0 / (light.constant + light.linear * distance + light.quadratic * (distance * distance));    
    // combine results
    vec3 ambient = light.ambient * vec3(texture(material.diffuse, TexCoords));
    vec3 diffuse = light.diffuse * diff * vec3(texture(material.diffuse, TexCoords));
    vec3 specular = light.specular * spec * vec3(texture(material.specular, TexCoords));
    ambient *= attenuation;
    diffuse *= attenuation;
    specular *= attenuation;
    return (ambient + diffuse + specular);
}

// calculates the color when using a spot light.
vec3 CalcSpotLight(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir)
{
    vec3 lightDir = normalize(light.position - fragPos);
    // diffuse shading
    float diff = max(dot(normal, lightDir), 0.0);
    // specular shading
    vec3 reflectDir = reflect(-lightDir, normal);
    float spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);
    // attenuation
    float distance = length(light.position - fragPos);
    float attenuation = 1.0 / (light.constant + light.linear * distance + light.quadratic * (distance * distance));    
    // spotlight intensity
    float theta = dot(lightDir, normalize(-light.direction)); 
    float epsilon = light.cutOff - light.outerCutOff;
    float intensity = clamp((theta - light.outerCutOff) / epsilon, 0.0, 1.0);
    // combine results
    vec3 ambient = light.ambient * vec3(texture(material.diffuse, TexCoords));
    vec3 diffuse = light.diffuse * diff * vec3(texture(material.diffuse, TexCoords));
    vec3 specular = light.specular * spec * vec3(texture(material.specular, TexCoords));
    ambient *= attenuation * intensity;
    diffuse *= attenuation * intensity;
    specular *= attenuation * intensity;
    return (ambient + diffuse + specular);
}
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">搜索</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>请在下面输入你要搜索的文本（仅支持英文）：</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="搜索..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>帮助</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>下一页</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>上一页</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>搜索</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
